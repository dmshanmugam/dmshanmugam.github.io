---
layout: post
title: Never transcribe numbers again
---

Transcribing numbers correctly is both difficult and boring. I've come up with two workflows for avoiding number transcription when writing research papers. They both require programmatically defining, exporting, and writing statistics you plan to report inline (see here for a discussion on how to do this for tables[^a]) For LaTex, the process is simple: you can print out a list of macros (of the form \macro{item_name}{value}), and refresh the macros every time you'd like to refresh your results. For Google Docs, the procedure is a bit more involved: 

1. **<u>Make internal + external Google Docs and a results Google Sheet</u>**. The internal doc is for edits, internal comments, and variable names; the external document is automatically populated with data.  The Google Sheet will store all data in key-value format.
2. **<u>Export data you intend to report to a CSV file</u>**. The first column should contain the item name and the second column the item value.
3. **<u>Import CSV into Google Sheet</u>**. Ensure the sheet name is 'output_results', as expected by the script. 
4. **<u>Modify script to include file IDs</u>**. The file IDs are at the end of each URL; remove trailing modifiers. 
5. **<u>Upload script to App Scripts</u>**. You can find the code [here](https://gist.github.com/divyashan/080391511fa8537765e0784a04c0ae07), and upload [here](https://script.google.com/home/projects/). 
6. **<u>Run the Google App script</u>**. The script will prompt you for permissions on its first run. The script will generate the external document according ot the internal document, replacing instances of KEY_A with VALUE_A, for all keys in the Google Sheet. Comments on the internal document will also transfer to the external document, but this function is easily removed.
7. **<u>Invite collaborators to comment on the external document</u>**. I restrict access to the internal doc to a smaller set of collaborators, who can then carefully propagate the feedback back into the internal state.

I produced the code in close collaboration with ChatGPT, making this a *doubly* generative procedure. The two document set-up is admittedly clunky -- I landed here because a single document doesn't allow for paper regeneration (since you'd overwrite your variable names). 

Email me if you have better ideas, or about ways you embed reproducibility into your research.

Divya

[^a]: To transcribe tables of results in LaTex, use the pandas [to_latex()](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_latex.html) function! I often write post-processing functions that modify this string to e.g. bold the best result across columns.To transcribe tables of results into a Google Doc, use the [to_markdown()](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_markdown.html) function. Copy the outputted text, right-click at the desired location, and select 'Paste from Markdown'. 