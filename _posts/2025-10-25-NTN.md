---
layout: post
title: Never transcribe numbers again
---

Transcribing numbers correctly is both difficult and boring. I've come up with two workflows for avoiding number transcription when writing research papers. They both require programmatically defining and exporting statistics you plan to report. For LaTex, the process is simple: you can print out a list of macro commands (of the form \macro{item_name}{value}), and refresh this list of commands every time you'd like to refresh your results.

For Google Docs, the procedure is a bit more involved: 

1. <u>**Make an internal and external Google doc and a results Google Sheet**</u>. The internal document is for edits, internal comments, and variable names; the external document is automatically populated with data.  The Google Sheet will store all data in key-value format.
2. <u>***Export data you intend to report to a CSV file**. The first column should be the item name and the second column should be the value.
3. <u>***Import CSV into your Google Sheet.** Ensure that the name of the sheet is 'output_results'; this is what the script below will look for.
4. <u>***Modify the script below to include IDs of each file**. Each of the three file IDs can be found at the end of its URL; make sure to remove trailing modifiers. 
5. **Upload the script to as an App Script**. You can find the code [here](https://gist.github.com/divyashan/080391511fa8537765e0784a04c0ae07), and the interfact to upload an App Script [here](https://script.google.com/home/projects/). 
6. **Run the Google App script**. The script will prompt you for permissions when it is first run. Your external document will be written over with the internal document, where places where you write {{KEY_A}} will be filled in with VALUE_A. Comments on the internal document will also transfer to the external document, but this function is easily removed.
7. **Invite collaborators to comment on the external document**. I find it easiest to restrict access to the internal doc to a smaller set of collaborators, who can then carefully propagate the feedback back into the internal state.

The code was produced in close collaboration with ChatGPT, making this a *doubly* generative procedure. The two document set-up is admittedly clunky -- I landed here because a single document doesn't allow for paper regeneration (since you'd overwrite your variable names). 

Email me if you have better ideas, or about ways you embed reproducibility into your research,

Divya